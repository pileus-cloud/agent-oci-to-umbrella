<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oracle FOCUS to Umbrella BYOD Transfer Agent - Installation Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        h2 {
            color: #2c3e50;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }

        h3 {
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        p {
            margin-bottom: 15px;
            color: #555;
        }

        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Courier New", monospace;
            color: #e83e8c;
            font-size: 0.9em;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: "Courier New", monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: #f8f8f2;
        }

        ul, ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 10px;
            color: #555;
        }

        .step-number {
            display: inline-block;
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 50%;
            margin-right: 10px;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #3498db;
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .command {
            background: #2d2d2d;
            color: #4ec9b0;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: "Courier New", monospace;
            font-size: 0.95em;
        }

        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 30px 0;
        }

        .toc h2 {
            margin-top: 0;
            font-size: 1.5em;
        }

        .toc ul {
            list-style: none;
            margin-left: 0;
        }

        .toc li {
            margin-bottom: 8px;
        }

        .toc a {
            color: #3498db;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 5px;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .badge-info {
            background: #17a2b8;
            color: white;
        }

        .badge-warning {
            background: #ffc107;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Oracle FOCUS to Umbrella BYOD Transfer Agent</h1>
        <p style="font-size: 1.2em; color: #7f8c8d; margin-bottom: 30px;">
            Complete Installation and Configuration Guide
        </p>

        <div class="toc">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#overview">1. Overview</a></li>
                <li><a href="#prerequisites">2. Prerequisites</a></li>
                <li><a href="#installation">3. Installation</a></li>
                <li><a href="#credentials">4. Credential Setup</a></li>
                <li><a href="#configuration">5. Configuration</a></li>
                <li><a href="#testing">6. Testing the Installation</a></li>
                <li><a href="#interactive">7. Running in Interactive Mode</a></li>
                <li><a href="#historical">8. Loading Historical Files</a></li>
                <li><a href="#production">9. Running in Production</a></li>
                <li><a href="#monitoring">10. Monitoring and Logs</a></li>
                <li><a href="#troubleshooting">11. Troubleshooting</a></li>
            </ul>
        </div>

        <h2 id="overview">1. Overview</h2>
        <p>
            The Oracle FOCUS to Umbrella BYOD Transfer Agent is an automated daemon that continuously monitors your Oracle Cloud Infrastructure (OCI) Object Storage for FOCUS cost reports and transfers them to your Umbrella BYOD S3 bucket.
        </p>

        <div class="info-box">
            <strong>What it does:</strong>
            <ul style="margin-top: 10px;">
                <li>Polls OCI Object Storage every 10 minutes for new FOCUS reports</li>
                <li>Streams files directly from OCI to S3 (no disk space needed)</li>
                <li>Renames files with date prefixes (YYYY-MM-DD_filename.csv.gz)</li>
                <li>Tracks transferred files to avoid duplicates</li>
                <li>Supports parallel transfers (3 files at once)</li>
                <li>Retries failed transfers with exponential backoff</li>
            </ul>
        </div>

        <h2 id="prerequisites">2. Prerequisites</h2>

        <h3>2.1 System Requirements</h3>
        <ul>
            <li><strong>Operating System:</strong> Linux, macOS, or Windows with Python 3.8+</li>
            <li><strong>Python:</strong> Version 3.8 or higher</li>
            <li><strong>Memory:</strong> Minimum 512 MB RAM (recommended 1 GB)</li>
            <li><strong>Network:</strong> Stable internet connection for OCI and AWS access</li>
        </ul>

        <h3>2.2 Required Access</h3>
        <ul>
            <li><strong>Oracle OCI:</strong> Read access to FOCUS reports in Object Storage</li>
            <li><strong>AWS S3:</strong> Write access to Umbrella BYOD bucket</li>
        </ul>

        <h3>2.3 Python Dependencies</h3>
        <p>The following Python packages are required:</p>
        <ul>
            <li><code>boto3</code> - AWS SDK for Python</li>
            <li><code>oci</code> - Oracle Cloud Infrastructure SDK</li>
            <li><code>PyYAML</code> - YAML configuration parser</li>
        </ul>

        <h2 id="installation">3. Installation</h2>

        <p>There are two installation methods available:</p>
        <ul>
            <li><strong>Method A:</strong> Automated Installation (Recommended for Linux servers)</li>
            <li><strong>Method B:</strong> Manual Installation (For development or custom setups)</li>
        </ul>

        <h3>Method A: Automated Installation (Linux Servers) <span class="badge badge-success">RECOMMENDED</span></h3>

        <p>Use this method to deploy the agent on production Linux servers. The deployment package includes an automated installer that sets up everything for you.</p>

        <h4><span class="step-number">1</span> Download Deployment Package</h4>
        <pre><code># Download from GitHub releases or build from source
wget https://github.com/pileus-cloud/oracle-focus-agent/releases/download/v1.0.0/oracle-focus-agent-1.0.0.tar.gz

# Or build the package yourself
./package.sh</code></pre>

        <div class="info-box">
            <strong>Package Contents:</strong>
            <ul style="margin-top: 10px;">
                <li>Python wheel package (ready to install)</li>
                <li>Systemd service file</li>
                <li>Automated installation script</li>
                <li>Configuration template</li>
                <li>Complete documentation</li>
            </ul>
        </div>

        <h4><span class="step-number">2</span> Transfer to Target Server</h4>
        <pre><code># Copy to your Linux server
scp oracle-focus-agent-1.0.0.tar.gz user@server:/tmp/

# SSH to the server
ssh user@server</code></pre>

        <h4><span class="step-number">3</span> Extract Package</h4>
        <pre><code>cd /tmp
tar -xzf oracle-focus-agent-1.0.0.tar.gz
cd oracle-focus-agent-1.0.0</code></pre>

        <h4><span class="step-number">4</span> Run Automated Installer</h4>
        <pre><code>sudo ./install.sh</code></pre>

        <div class="success-box">
            <strong>What the installer does:</strong>
            <ul style="margin-top: 10px;">
                <li>✅ Checks Python 3.8+ requirement</li>
                <li>✅ Installs pip3 if needed (Ubuntu, RHEL, CentOS)</li>
                <li>✅ Creates dedicated service user (<code>oracle-agent</code>)</li>
                <li>✅ Creates directories: <code>/opt</code>, <code>/etc</code>, <code>/var/log</code>, <code>/var/lib</code></li>
                <li>✅ Installs Python package and dependencies</li>
                <li>✅ Copies configuration template to <code>/etc/oracle-focus-agent/config.yaml</code></li>
                <li>✅ Installs systemd service</li>
                <li>✅ Tests the installation</li>
            </ul>
        </div>

        <h4><span class="step-number">5</span> Configure the Agent</h4>
        <p>After installation completes, follow the on-screen instructions to configure:</p>
        <pre><code># Edit main configuration
sudo nano /etc/oracle-focus-agent/config.yaml

# Setup OCI credentials
sudo mkdir -p /root/.oci
sudo nano /root/.oci/config
# Copy your OCI private key
sudo cp /path/to/key.pem /root/.oci/
sudo chmod 600 /root/.oci/oci_api_key.pem

# Setup AWS credentials
sudo mkdir -p /root/.aws
sudo nano /root/.aws/credentials</code></pre>

        <h4><span class="step-number">6</span> Test and Start</h4>
        <pre><code># Test configuration
sudo oracle-focus-agent test --config /etc/oracle-focus-agent/config.yaml

# Enable auto-start on boot
sudo systemctl enable oracle-focus-agent

# Start the service
sudo systemctl start oracle-focus-agent

# Check status
sudo systemctl status oracle-focus-agent</code></pre>

        <div class="success-box">
            <strong>Installation Complete!</strong> The agent is now running as a systemd service and will automatically start on boot.
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #e0e0e0;">

        <h3>Method B: Manual Installation (Development/Custom Setup)</h3>

        <p>Use this method for development environments or if you want more control over the installation process.</p>

        <h4><span class="step-number">1</span> Clone or Download the Project</h4>
        <pre><code># If using git
git clone https://github.com/pileus-cloud/oracle-focus-agent.git
cd oracle-focus-agent

# Or download and extract the ZIP file
unzip oracle-focus-agent.zip
cd oracle-focus-agent</code></pre>

        <h4><span class="step-number">2</span> Install Python Dependencies</h4>
        <pre><code>pip3 install boto3 oci PyYAML</code></pre>

        <div class="info-box">
            <strong>Tip:</strong> Consider using a virtual environment to isolate dependencies:
            <pre style="margin-top: 10px;"><code>python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install boto3 oci PyYAML</code></pre>
        </div>

        <h4><span class="step-number">3</span> Install the Agent</h4>
        <pre><code># Development mode (editable install)
pip3 install -e .

# Or install from wheel
pip3 install dist/oracle_focus_agent-1.0.0-py3-none-any.whl</code></pre>

        <h4><span class="step-number">4</span> Verify Installation</h4>
        <pre><code>oracle-focus-agent --help</code></pre>

        <div class="success-box">
            <strong>Expected Output:</strong> You should see the help message with available commands (start, stop, run, test, sync, status).
        </div>

        <h2 id="credentials">4. Credential Setup</h2>

        <h3>4.1 Oracle OCI Credentials</h3>
        <p>The agent uses the standard OCI configuration file (<code>~/.oci/config</code>).</p>

        <h4>Create OCI Config File</h4>
        <p>If you don't have an OCI config file yet, create <code>~/.oci/config</code>:</p>
        <pre><code>[DEFAULT]
user=ocid1.user.oc1..your-user-ocid
fingerprint=aa:bb:cc:dd:ee:ff:00:11:22:33:44:55:66:77:88:99
tenancy=ocid1.tenancy.oc1..your-tenancy-ocid
region=us-ashburn-1
key_file=~/.oci/oci_api_key.pem</code></pre>

        <div class="warning-box">
            <strong>Important:</strong> Ensure your private key file (<code>oci_api_key.pem</code>) has proper permissions:
            <pre style="margin-top: 10px;"><code>chmod 600 ~/.oci/oci_api_key.pem</code></pre>
        </div>

        <h3>4.2 AWS S3 Credentials</h3>
        <p>The agent uses standard AWS credentials from <code>~/.aws/credentials</code>.</p>

        <h4>Create AWS Credentials File</h4>
        <pre><code>mkdir -p ~/.aws
cat &gt; ~/.aws/credentials &lt;&lt;EOF
[default]
aws_access_key_id = YOUR_ACCESS_KEY_ID
aws_secret_access_key = YOUR_SECRET_ACCESS_KEY
EOF

chmod 600 ~/.aws/credentials</code></pre>

        <div class="info-box">
            <strong>Finding Your AWS Credentials:</strong>
            <ul style="margin-top: 10px;">
                <li><strong>Access Key ID:</strong> Identifies your AWS account (e.g., AKIA5P3M7ROSGD6XXZIQ)</li>
                <li><strong>Secret Access Key:</strong> The password for your access key (keep this secure!)</li>
                <li>Both are required for AWS authentication</li>
            </ul>
        </div>

        <h3>4.3 Test Credentials</h3>
        <p>Verify your credentials work:</p>
        <pre><code># Test OCI
oci os ns get

# Test AWS S3
aws s3 ls s3://your-bucket-name/ --region us-east-1</code></pre>

        <h2 id="configuration">5. Configuration</h2>

        <h3>5.1 Create Configuration File</h3>
        <p>Copy the template and customize for your environment:</p>
        <pre><code>cp config.template.yaml config.yaml</code></pre>

        <h3>5.2 Configure OCI Settings</h3>
        <p>Edit <code>config.yaml</code> and update the OCI section:</p>
        <pre><code>oci:
  # Path to your OCI config file
  config_file: "~/.oci/config"

  # Profile name in config file
  profile: "DEFAULT"

  # Oracle billing namespace (use "bling", NOT your tenancy namespace)
  namespace: "bling"

  # Bucket name (your tenancy OCID)
  bucket: "ocid1.tenancy.oc1..aaaaaaaatjusogdqicpfl5vfvl7q474vm2ao7lzffenavtmwkc4p6olszjoq"

  # Prefix for FOCUS reports
  prefix: "FOCUS Reports/"</code></pre>

        <div class="warning-box">
            <strong>Important:</strong>
            <ul style="margin-top: 10px;">
                <li>Use <code>namespace: "bling"</code> (Oracle's billing namespace)</li>
                <li>Use your tenancy OCID as the bucket name</li>
            </ul>
        </div>

        <h3>5.3 Configure S3 Settings</h3>
        <pre><code>s3:
  # Full S3 path including your organization's prefix
  bucket_path: "s3://your-umbrella-bucket/your-org-id/0/YourName-id"

  # AWS region
  region: "us-east-1"

  # Leave credentials empty (uses ~/.aws/credentials)
  access_key_id: ""
  secret_access_key: ""</code></pre>

        <h3>5.4 Configure Agent Settings</h3>
        <pre><code>agent:
  # Polling interval in seconds (600 = 10 minutes)
  poll_interval: 600

  # Number of days to look back (1 = yesterday + today)
  lookback_days: 1

  # Maximum concurrent file transfers
  max_concurrent_transfers: 3

  # Enable daemon mode
  daemon_mode: true</code></pre>

        <div class="info-box">
            <strong>Key Settings:</strong>
            <ul style="margin-top: 10px;">
                <li><code>poll_interval</code>: How often to check for new files (seconds)</li>
                <li><code>lookback_days</code>: Number of past days to scan for files</li>
                <li><code>max_concurrent_transfers</code>: Parallel upload limit (3 recommended)</li>
            </ul>
        </div>

        <h2 id="testing">6. Testing the Installation</h2>

        <h3><span class="step-number">1</span> Test Configuration and Connectivity</h3>
        <pre><code>oracle-focus-agent test --config config.yaml</code></pre>

        <div class="success-box">
            <strong>Expected Output:</strong>
            <pre style="margin-top: 10px;"><code>Configuration Test
======================================================================
✓ OCI config file: ~/.oci/config [DEFAULT]
✓ OCI namespace: bling
✓ OCI bucket: ocid1.tenancy.oc1..aaaaaaaatjusogdqicpfl5vfvl7q474vm2ao7lzffenavtmwkc4p6olszjoq
✓ OCI connectivity: OK
✓ S3 bucket path: s3://your-bucket/...
✓ S3 region: us-east-1
✓ S3 connectivity: OK
✓ State file: ./state/state.json
  - Tracked files: 0

✓ All tests passed!</code></pre>
        </div>

        <h3><span class="step-number">2</span> Perform Test Sync</h3>
        <p>Run a one-time sync to verify file transfers work:</p>
        <pre><code>oracle-focus-agent sync --config config.yaml</code></pre>

        <div class="success-box">
            <strong>Expected Output:</strong>
            <pre style="margin-top: 10px;"><code>======================================================================
Starting sync operation
======================================================================
Processing date range: 2025-11-24 to 2025-11-25 (2 days)
Discovered 6 total files
Files to transfer: 6
Files skipped (already transferred): 0
Starting parallel transfers (max 3 concurrent)
✓ Transferred: 2025-11-24_0001000002711283-00001.csv.gz (124.47 KB)
✓ Transferred: 2025-11-24_0001000002711630-00001.csv.gz (213.04 KB)
✓ Transferred: 2025-11-24_0001000002711992-00001.csv.gz (240.18 KB)
...
======================================================================
Sync operation complete
  Discovered: 6
  Transferred: 6
  Skipped: 0
  Failed: 0
  Data transferred: 989.41 KB
  Duration: 4.0s
======================================================================</code></pre>
        </div>

        <h3><span class="step-number">3</span> Verify State Tracking</h3>
        <p>Run sync again to verify files are skipped:</p>
        <pre><code>oracle-focus-agent sync --config config.yaml</code></pre>

        <div class="success-box">
            <strong>Expected Output:</strong>
            <pre style="margin-top: 10px;"><code>Discovered: 6 total files
Files to transfer: 0
Files skipped (already transferred): 6
All files already transferred</code></pre>
        </div>

        <h2 id="interactive">7. Running in Interactive Mode</h2>

        <p>
            Interactive mode runs the agent in the foreground, making it perfect for testing and monitoring real-time behavior.
            The agent will poll every 10 minutes and display all activity in your terminal.
        </p>

        <h3>Start Interactive Mode</h3>
        <pre><code>oracle-focus-agent run --config config.yaml</code></pre>

        <div class="info-box">
            <strong>Interactive Mode Features:</strong>
            <ul style="margin-top: 10px;">
                <li>Real-time log output directly to your terminal</li>
                <li>Polls every 10 minutes (configurable via <code>poll_interval</code>)</li>
                <li>Press <kbd>Ctrl+C</kbd> to stop gracefully</li>
                <li>Perfect for testing and debugging</li>
                <li>See transfer progress immediately</li>
            </ul>
        </div>

        <div class="success-box">
            <strong>Example Output:</strong>
            <pre style="margin-top: 10px;"><code>2025-11-25 10:00:00 - INFO - Starting agent in foreground mode (Ctrl+C to stop)
2025-11-25 10:00:00 - INFO - Starting sync operation
2025-11-25 10:00:02 - INFO - Discovered 3 total files
2025-11-25 10:00:02 - INFO - Files to transfer: 3
2025-11-25 10:00:05 - INFO - ✓ Transferred: 2025-11-25_0001000002713240-00001.csv.gz
2025-11-25 10:00:06 - INFO - Sync operation complete
2025-11-25 10:00:06 - INFO - Next sync in 600 seconds...
2025-11-25 10:10:00 - INFO - Starting sync operation
...</code></pre>
        </div>

        <h3>Stop Interactive Mode</h3>
        <p>Press <kbd>Ctrl+C</kbd> to stop the agent gracefully:</p>
        <pre><code>^C
2025-11-25 10:15:30 - INFO - Stopped by user</code></pre>

        <h2 id="historical">8. Loading Historical Files</h2>

        <p>
            If you need to load historical FOCUS files from the past (e.g., last 10 days, 30 days, etc.),
            follow these steps:
        </p>

        <h3><span class="step-number">1</span> Configure Lookback Period</h3>
        <p>Edit <code>config.yaml</code> and set <code>lookback_days</code> to your desired period:</p>
        <pre><code>agent:
  # Load last 10 days of historical files
  lookback_days: 10</code></pre>

        <table>
            <thead>
                <tr>
                    <th>Lookback Days</th>
                    <th>Date Range</th>
                    <th>Use Case</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Yesterday + Today</td>
                    <td>Normal daily operation</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>Last 7 days</td>
                    <td>Weekly backfill</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>Last 10 days</td>
                    <td>Initial setup / testing</td>
                </tr>
                <tr>
                    <td>30</td>
                    <td>Last 30 days</td>
                    <td>Monthly historical load</td>
                </tr>
                <tr>
                    <td>90</td>
                    <td>Last 90 days</td>
                    <td>Quarterly historical load</td>
                </tr>
            </tbody>
        </table>

        <h3><span class="step-number">2</span> Force Sync Historical Files</h3>
        <p>Use the <code>--force</code> flag to transfer all discovered files, ignoring state tracking:</p>
        <pre><code>oracle-focus-agent sync --config config.yaml --force</code></pre>

        <div class="warning-box">
            <strong>Force Mode Behavior:</strong>
            <ul style="margin-top: 10px;">
                <li>Ignores <code>state.json</code> completely</li>
                <li>Re-transfers ALL files in the date range</li>
                <li>Overwrites existing files in S3</li>
                <li>Useful when Oracle updates files</li>
            </ul>
        </div>

        <div class="success-box">
            <strong>Example: Load Last 10 Days</strong>
            <pre style="margin-top: 10px;"><code># Step 1: Edit config.yaml
agent:
  lookback_days: 10

# Step 2: Force sync
oracle-focus-agent sync --config config.yaml --force

# Output:
Starting sync operation (FORCED - ignoring state)
Processing date range: 2025-11-15 to 2025-11-25 (10 days)
Discovered 66 total files
Force mode enabled: transferring all files regardless of state
Files to transfer: 66
Files skipped: 0 (force mode: re-transferring all)
✓ Transferred: 2025-11-15_0001000002701234-00001.csv.gz
✓ Transferred: 2025-11-15_0001000002701456-00001.csv.gz
...
Sync operation complete
  Discovered: 66
  Transferred: 66
  Skipped: 0
  Failed: 0
  Data transferred: 11.13 MB
  Duration: 19.7s</code></pre>
        </div>

        <h3><span class="step-number">3</span> Reset to Normal Operation</h3>
        <p>After loading historical files, reset <code>lookback_days</code> to normal operation:</p>
        <pre><code>agent:
  # Back to normal: yesterday + today
  lookback_days: 1</code></pre>

        <h3>Historical Loading Strategies</h3>

        <table>
            <thead>
                <tr>
                    <th>Strategy</th>
                    <th>Configuration</th>
                    <th>Command</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Initial Setup</strong></td>
                    <td><code>lookback_days: 10</code></td>
                    <td><code>sync --force</code></td>
                </tr>
                <tr>
                    <td><strong>Monthly Backfill</strong></td>
                    <td><code>lookback_days: 30</code></td>
                    <td><code>sync --force</code></td>
                </tr>
                <tr>
                    <td><strong>Re-sync Updated Files</strong></td>
                    <td><code>lookback_days: 7</code></td>
                    <td><code>sync --force</code></td>
                </tr>
                <tr>
                    <td><strong>Daily Operation</strong></td>
                    <td><code>lookback_days: 1</code></td>
                    <td><code>run</code> (daemon mode)</td>
                </tr>
            </tbody>
        </table>

        <h2 id="production">9. Running in Production</h2>

        <h3>9.1 Start as Background Daemon</h3>
        <pre><code>oracle-focus-agent start --config config.yaml</code></pre>

        <div class="success-box">
            <strong>Output:</strong>
            <pre style="margin-top: 10px;"><code>Starting daemon in background...
Daemon started with PID 12345</code></pre>
        </div>

        <h3>9.2 Check Daemon Status</h3>
        <pre><code>oracle-focus-agent status</code></pre>

        <div class="success-box">
            <strong>Output:</strong>
            <pre style="margin-top: 10px;"><code>Daemon is running with PID 12345</code></pre>
        </div>

        <h3>9.3 Stop Daemon</h3>
        <pre><code>oracle-focus-agent stop</code></pre>

        <div class="success-box">
            <strong>Output:</strong>
            <pre style="margin-top: 10px;"><code>Stopping daemon (PID 12345)...
Daemon stopped successfully</code></pre>
        </div>

        <h3>9.4 Production Best Practices</h3>
        <ul>
            <li><strong>Use systemd:</strong> Create a systemd service for auto-start on boot</li>
            <li><strong>Monitor logs:</strong> Set up log rotation and monitoring</li>
            <li><strong>Set alerts:</strong> Alert on transfer failures</li>
            <li><strong>Review state:</strong> Periodically check <code>state/state.json</code></li>
            <li><strong>Secure credentials:</strong> Use proper file permissions (chmod 600)</li>
        </ul>

        <h2 id="monitoring">10. Monitoring and Logs</h2>

        <h3>10.1 View Real-Time Logs</h3>
        <pre><code>tail -f logs/agent.log</code></pre>

        <h3>10.2 Check Transfer State</h3>
        <pre><code>cat state/state.json</code></pre>

        <div class="info-box">
            <strong>State File Contains:</strong>
            <ul style="margin-top: 10px;">
                <li>All transferred files with timestamps</li>
                <li>File sizes and creation times</li>
                <li>Transfer durations</li>
                <li>Last sync timestamp</li>
            </ul>
        </div>

        <h3>10.3 Log Levels</h3>
        <p>Configure log verbosity in <code>config.yaml</code>:</p>
        <pre><code>logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR</code></pre>

        <h3>10.4 Key Metrics to Monitor</h3>
        <table>
            <thead>
                <tr>
                    <th>Metric</th>
                    <th>Where to Find</th>
                    <th>What to Watch</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Files Transferred</td>
                    <td>Logs: "Transferred: X"</td>
                    <td>Should match Oracle's file count</td>
                </tr>
                <tr>
                    <td>Files Skipped</td>
                    <td>Logs: "Skipped: X"</td>
                    <td>Should increase after initial load</td>
                </tr>
                <tr>
                    <td>Files Failed</td>
                    <td>Logs: "Failed: X"</td>
                    <td>Should be 0</td>
                </tr>
                <tr>
                    <td>Transfer Duration</td>
                    <td>Logs: "Duration: Xs"</td>
                    <td>Monitor for slow transfers</td>
                </tr>
                <tr>
                    <td>State File Size</td>
                    <td><code>ls -lh state/state.json</code></td>
                    <td>Grows over time</td>
                </tr>
            </tbody>
        </table>

        <h2 id="troubleshooting">11. Troubleshooting</h2>

        <h3>Problem: OCI Connectivity Test Fails</h3>
        <div class="warning-box">
            <strong>Error:</strong> <code>✗ OCI connectivity: FAILED - Invalid credentials</code>
        </div>
        <p><strong>Solutions:</strong></p>
        <ul>
            <li>Verify <code>~/.oci/config</code> exists and is properly formatted</li>
            <li>Check private key path is correct: <code>key_file=~/.oci/oci_api_key.pem</code></li>
            <li>Ensure private key has correct permissions: <code>chmod 600 ~/.oci/oci_api_key.pem</code></li>
            <li>Test OCI CLI: <code>oci os ns get</code></li>
        </ul>

        <h3>Problem: S3 Connectivity Test Fails</h3>
        <div class="warning-box">
            <strong>Error:</strong> <code>✗ S3 connectivity: FAILED - Access Denied</code>
        </div>
        <p><strong>Solutions:</strong></p>
        <ul>
            <li>Verify <code>~/.aws/credentials</code> contains valid credentials</li>
            <li>Check AWS credentials permissions: <code>chmod 600 ~/.aws/credentials</code></li>
            <li>Verify S3 bucket path is correct in <code>config.yaml</code></li>
            <li>Test AWS CLI: <code>aws s3 ls s3://your-bucket/ --region us-east-1</code></li>
            <li>Ensure IAM user has <code>s3:PutObject</code> permission</li>
        </ul>

        <h3>Problem: No Files Discovered</h3>
        <div class="warning-box">
            <strong>Output:</strong> <code>Discovered 0 total files</code>
        </div>
        <p><strong>Solutions:</strong></p>
        <ul>
            <li>Verify OCI namespace is <code>"bling"</code> (not your tenancy namespace)</li>
            <li>Check bucket name is your tenancy OCID</li>
            <li>Verify prefix: <code>"FOCUS Reports/"</code> (with trailing slash)</li>
            <li>Increase <code>lookback_days</code> to search more days</li>
            <li>Check if Oracle has generated FOCUS reports yet</li>
        </ul>

        <h3>Problem: Files Not Transferring (All Skipped)</h3>
        <div class="warning-box">
            <strong>Output:</strong> <code>Files to transfer: 0, Skipped: 10</code>
        </div>
        <p><strong>Solutions:</strong></p>
        <ul>
            <li>Files were already transferred (check <code>state/state.json</code>)</li>
            <li>To re-transfer, use <code>--force</code> flag: <code>oracle-focus-agent sync --config config.yaml --force</code></li>
            <li>Or delete state file to start fresh: <code>rm state/state.json</code></li>
        </ul>

        <h3>Problem: Daemon Won't Start</h3>
        <div class="warning-box">
            <strong>Error:</strong> <code>Error: Daemon already running with PID 12345</code>
        </div>
        <p><strong>Solutions:</strong></p>
        <ul>
            <li>Check if daemon is actually running: <code>oracle-focus-agent status</code></li>
            <li>Stop existing daemon: <code>oracle-focus-agent stop</code></li>
            <li>If stuck, kill process manually: <code>kill $(cat /tmp/oracle-focus-agent.pid)</code></li>
            <li>Remove stale PID file: <code>rm /tmp/oracle-focus-agent.pid</code></li>
        </ul>

        <h3>Problem: Transfer Failures</h3>
        <div class="warning-box">
            <strong>Output:</strong> <code>Failed: 3, Errors: [...]</code>
        </div>
        <p><strong>Solutions:</strong></p>
        <ul>
            <li>Check logs for specific error messages: <code>tail -100 logs/agent.log</code></li>
            <li>Verify network connectivity to both OCI and AWS</li>
            <li>Check file sizes aren't exceeding limits (default: 5 GB)</li>
            <li>Retry with: <code>oracle-focus-agent sync --config config.yaml --force</code></li>
            <li>Increase retry settings in <code>config.yaml</code></li>
        </ul>

        <h3>Problem: Slow Transfers</h3>
        <div class="warning-box">
            <strong>Symptom:</strong> Transfers taking much longer than expected
        </div>
        <p><strong>Solutions:</strong></p>
        <ul>
            <li>Check network bandwidth and latency</li>
            <li>Increase concurrent transfers (max 5): <code>max_concurrent_transfers: 5</code></li>
            <li>Adjust chunk size (default 8MB): <code>chunk_size_bytes: 16777216</code></li>
            <li>Run from a server closer to OCI/AWS regions</li>
        </ul>

        <h3>Getting Help</h3>
        <div class="info-box">
            <strong>Support Resources:</strong>
            <ul style="margin-top: 10px;">
                <li><strong>Documentation:</strong> Check README.md, QUICKSTART.md, REQUIREMENTS.md</li>
                <li><strong>Logs:</strong> Review <code>logs/agent.log</code> for detailed errors</li>
                <li><strong>State:</strong> Inspect <code>state/state.json</code> for transfer history</li>
                <li><strong>Test Mode:</strong> Run <code>oracle-focus-agent test --config config.yaml</code></li>
                <li><strong>Verbose Logs:</strong> Set <code>level: "DEBUG"</code> in config for more detail</li>
            </ul>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #e0e0e0;">

        <h2>Quick Reference Commands</h2>
        <table>
            <thead>
                <tr>
                    <th>Task</th>
                    <th>Command</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Test configuration</td>
                    <td><code>oracle-focus-agent test --config config.yaml</code></td>
                </tr>
                <tr>
                    <td>One-time sync</td>
                    <td><code>oracle-focus-agent sync --config config.yaml</code></td>
                </tr>
                <tr>
                    <td>Force re-transfer all</td>
                    <td><code>oracle-focus-agent sync --config config.yaml --force</code></td>
                </tr>
                <tr>
                    <td>Run interactively</td>
                    <td><code>oracle-focus-agent run --config config.yaml</code></td>
                </tr>
                <tr>
                    <td>Start daemon</td>
                    <td><code>oracle-focus-agent start --config config.yaml</code></td>
                </tr>
                <tr>
                    <td>Check status</td>
                    <td><code>oracle-focus-agent status</code></td>
                </tr>
                <tr>
                    <td>Stop daemon</td>
                    <td><code>oracle-focus-agent stop</code></td>
                </tr>
                <tr>
                    <td>View logs</td>
                    <td><code>tail -f logs/agent.log</code></td>
                </tr>
                <tr>
                    <td>Check state</td>
                    <td><code>cat state/state.json</code></td>
                </tr>
            </tbody>
        </table>

        <div class="success-box" style="margin-top: 40px;">
            <h3 style="margin-top: 0;">Installation Complete!</h3>
            <p>Your Oracle FOCUS to Umbrella BYOD Transfer Agent is ready to use. Start with:</p>
            <pre style="margin-top: 10px;"><code>oracle-focus-agent test --config config.yaml</code></pre>
        </div>

        <p style="text-align: center; color: #7f8c8d; margin-top: 40px; font-size: 0.9em;">
            Oracle FOCUS to Umbrella BYOD Transfer Agent v1.0 | Last Updated: November 25, 2025
        </p>
    </div>
</body>
</html>
